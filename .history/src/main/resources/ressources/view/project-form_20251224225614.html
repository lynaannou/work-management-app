<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ECLIPSEWORK ‚Äì Project</title>
  <link rel="stylesheet" href="project-form.css">
</head>
<body>

<!-- =========================
     NAVBAR
========================= -->
<div class="navbar">
  <div class="nav-left">
    <div class="brand">ECLIPSEWORK</div>

    <div class="nav-links">
      <a href="#" onclick="goDashboard()">DASHBOARD</a>
      <a href="#" class="active">PROJECTS</a>
      <a href="#" onclick="goTasks()">TASKS</a>
    </div>
  </div>

  <div class="nav-right">
    <div class="avatar">
      <img src="user.png" alt="user">
    </div>
    <div class="user-name">FULL NAME</div>
  </div>
</div>

<!-- =========================
     PAGE TITLE
========================= -->
<h2 class="page-title">BEGIN A NEW PROJECT</h2>

<!-- =========================
     PROJECT FORM
========================= -->
<div class="form-container">

  <label>TITLE</label>
  <input
    type="text"
    id="projectTitle"
    placeholder="PROJECT‚ÄôS TITLE"
  />

  <label>DESCRIPTION</label>
  <textarea
    id="projectDescription"
    placeholder="PROJECT‚ÄôS DESCRIPTION"
  ></textarea>

  <label>INVITE MEMBERS</label>
  <input
    type="email"
    id="inviteEmail"
    placeholder="INSERT EMAIL"
  />

  <label>TASKS</label>
  <button class="btn-secondary" onclick="checkTasks()">
    CHECK TASKS
  </button>

  <div class="actions">
    <button class="btn-save" onclick="saveProject()">
      SAVE PROJECT
    </button>

    <button class="btn-delete" onclick="deleteProject()">
      DELETE PROJECT
    </button>
  </div>
</div>

<script>
function goDashboard() {
  if (window.java && window.java.goDashboard) {
    window.java.goDashboard();
  }
}

function goTasks() {
  if (window.java && window.java.goTasks) {
    window.java.goTasks();
  }
}

function checkTasks() {
  console.log("üìã Check tasks clicked");
}

function saveProject() {
  console.log("üíæ Save project clicked");
}

function deleteProject() {
  console.log("üóëÔ∏è Delete project clicked");
}
</script>
<script>
/* =========================
   USER CONTEXT INITIALIZATION
========================= */
(function initUserContext() {

  if (!window.javaBridge) {
    console.error("‚ùå javaBridge not available");
    return;
  }

  const raw = window.javaBridge.getCurrentUserInfo();

  if (!raw || raw === "{}") {
    console.error("‚ùå No authenticated user");
    return;
  }

  try {
    const user = JSON.parse(raw);

    // Global user object (SINGLE SOURCE OF TRUTH)
    window.currentUser = {
      id: user.userId,
      fullName: user.firstName + " " + user.lastName,
      email: user.email,
      role: user.role
    };

    // Update header
    const nameEl = document.querySelector(".user-name");
    if (nameEl) {
      nameEl.textContent = window.currentUser.fullName;
    }

    console.log("‚úÖ Current user loaded:", window.currentUser);

  } catch (e) {
    console.error("‚ùå Failed to parse user info", e);
  }
})();
</script>


</body>
</html>
